это просто набросок, результаты будут не в xml а в json

Вызов API
http://servername/api/{func_name}?player_id=укажите_id_вашего_плеера&format={xml|json}
где func_name - имя функции.
если format=xml или этот параметр отсутствует, то результат будет в xml
если вы вызываете api из javascript, то укажите format=json
если вы хотите реализовать callback для javascript, то добавьте параметр callback=json_callback_function эта функция вызовется после получения json данных, результат запроса будет передан этой функции в виде хэша первым параметром
параметры функции передаются через GET или POST переменные.
Если какое-либо значение параметра или результата отсутствует, значит оно равно нулю или пустой строке.



Результат запроса в случае успеха:
<?xml version="1.0" encoding="UTF-8"?>
<result>
...
</result>

Результат запроса в случае ошибки:
<?xml version="1.0" encoding="UTF-8"?>
<error>
<code>код ошибки</code>
<text>расшифровка ошибки</text>
</error>

Коды ошибок:
TRY_AGAIN - она же Bad gateway 502, означает что сервис временно недоступен (возможно из-за большой нагрузки) и нужно повторить ваш запрос через несколько секунд. Ошибка возникает достаточно редко, но всё же стоит её учитывать.
USER_DELETED - пользователь удалился
WRONG_CODE - неверно введён код защиты (капча)
EMPTY_MESSAGE - пустое сообщение
DISK_LOCK - редкая ошибка, но всё же иногда может быть. Означает, что производятся профилактические работы с диском на котором хранятся сообщения и контакты пользователя.

Также нужно предусмотреть обработку ошибки HTTP 502 (а тажке других 5xx ошибок). Такая ошибка значит, что либо сервер перегружен, либо ведутся технические работы, и нужно через секунд 10-15 сделать повторный запрос.

_reg


_play


_next


_prev

